services:
  # NestJS API - Connects to Amazon RDS PostgreSQL
  api:
    image: ghcr.io/dynnamocrypt/urgara-jornales-api:latest
    container_name: urgara-jornales-api
    restart: unless-stopped
    environment:
      NODE_ENV: ${NODE_ENV:-production}
      PORT: ${PORT:-3000}
      DATABASE_COMMON_URL: ${DATABASE_COMMON_URL}
      DATABASE_LOCALITY_URL: ${DATABASE_LOCALITY_URL}
      CORS_ORIGIN: ${CORS_ORIGIN}
      COOKIE_SECRET: ${COOKIE_SECRET}
      JWT_SECRET_CLIENT: ${JWT_SECRET_CLIENT}
      JWT_SECRET_REFRESH: ${JWT_SECRET_REFRESH}
    ports:
      - '${PORT:-3000}:${PORT:-3000}'
    networks:
      - urgara-jornales-network
    volumes:
      - ./logs:/app/logs

networks:
  urgara-jornales-network:
    driver: bridge
